# API –¥–ª—è CloudFlare R2

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—É–±–ª–∏—á–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã —á–µ—Ä–µ–∑ `GET /path`, –ª–∏–±–æ –∑–∞–ª–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ `POST /path`.
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [proselog/r2-api](https://github.com/proselog/r2-api). –í—ã—Ä–µ–∑–∞–Ω JWT —Ç–æ–∫–µ–Ω, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ —Å–≤–æ–µ–º—É –ø—É—Ç–∏, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è —Å–≤–æ–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö. üëâ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ Telegram –±–æ—Ç–µ [t.me/cfr2bot](https://t.me/cfr2bot)

## wrangler.toml:

–í —Ñ–∞–π–ª–µ –µ—Å—Ç—å –±–ª–æ–∫ `env.development.*`, –æ–Ω –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –µ—Å–ª–∏ –¥–µ–ª–∞—Ç—å `wrangler dev/publish --env development`

- `name` ‚Äì —Å–æ–∑–¥–∞—Å—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç –≤–æ—Ä–∫–µ—Ä–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º
- `bucket_name` ‚Äì –∏–º—è –±–∞–∫–µ—Ç–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å `wrangler publish`
- `preview_bucket_name` ‚Äì —á—Ç–æ –∏ —Å–≤–µ—Ä—Ö—É –Ω–æ –¥–ª—è `wrangler dev`
- `ENCRYPT_SECRET` ‚Äì —É—Å–ª–æ–≤–Ω–æ "–ø–∞—Ä–æ–ª—å", –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ —É–∫–∞–∑–∞—Ç—å –≤ `Authorization` —Ö–µ–¥–µ—Ä–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ `wrangler secret put ENCRYPT_SECRET`, —á—Ç–æ–±—ã –ø–æ—Å–ª–µ `publish` —É –≤–æ—Ä–∫–µ—Ä–∞ –±—ã–ª env

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

- `git clone` —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `npm i` –≤ —Å–∫–∞—á–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ wrangler –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `wrangler r2 bucket create NAME` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è R2 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- `wrangler secret put ENCRYPT_SECRET` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–æ–ª—è
- –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `wrangler.toml`, –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ
- `wrangler dev` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ –∏ `wrangler publish`, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –≤–æ—Ä–∫–µ—Ä

## Upload —Ñ–∞–π–ª–∞

`curl -X POST -H "Authorization: xxx" -F "file=@/path/to/file.ext" http://localhost:8787/`, –≥–¥–µ `xxx` —ç—Ç–æ `ENCRYPT_SECRET`

–ï—Å–ª–∏ –∑–∞–ª–∏—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞ –ø–æ –æ–¥–Ω–æ–º—É `/path`, —Ç–æ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Å—Ç–∞—Ä—ã–π
