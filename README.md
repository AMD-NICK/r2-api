# API –¥–ª—è CloudFlare R2

–ü–æ–∑–≤–æ–ª—è–µ—Ç –ø—É–±–ª–∏—á–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã —á–µ—Ä–µ–∑ `GET /path`, –ª–∏–±–æ –∑–∞–ª–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ `POST /path`.
–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [proselog/r2-api](https://github.com/proselog/r2-api). –í—ã—Ä–µ–∑–∞–Ω JWT —Ç–æ–∫–µ–Ω, –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ —Å–≤–æ–µ–º—É –ø—É—Ç–∏, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è —Å–≤–æ–∏—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö. üëâ –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ Telegram –±–æ—Ç–µ [t.me/cfr2bot](https://t.me/cfr2bot)

## wrangler.toml:

–í —Ñ–∞–π–ª–µ –µ—Å—Ç—å –±–ª–æ–∫ `env.development.*`, –æ–Ω –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –µ—Å–ª–∏ –¥–µ–ª–∞—Ç—å `wrangler dev/deploy --env development`

- `name` ‚Äì —Å–æ–∑–¥–∞—Å—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç –≤–æ—Ä–∫–µ—Ä–∞ —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º
- `bucket_name` ‚Äì –∏–º—è –±–∞–∫–µ—Ç–∞, —Å –∫–æ—Ç–æ—Ä—ã–º –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å `wrangler deploy`
- `preview_bucket_name` ‚Äì —á—Ç–æ –∏ —Å–≤–µ—Ä—Ö—É –Ω–æ –¥–ª—è `wrangler dev`. –¢.–µ. –ø—Ä–∏ `wrangler dev` –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–æ—Ç bucket. –ú–æ–∂–Ω–æ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
- `ENCRYPT_SECRET` ‚Äì —É—Å–ª–æ–≤–Ω–æ "–ø–∞—Ä–æ–ª—å", –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–¥–æ —É–∫–∞–∑–∞—Ç—å –≤ `Authorization` —Ö–µ–¥–µ—Ä–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤. –í –∫–æ–¥–µ —ç—Ç–æ `env.ENCRYPT_SECRET`. –ù—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è `--env development`

–î–ª—è `wrangler deploy` –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–≤–µ—Å—Ç–∏ `wrangler secret put ENCRYPT_SECRET`, —á—Ç–æ–±—ã —É –≤–æ—Ä–∫–µ—Ä–∞ –≤ –ø—Ä–æ–¥–µ –±—ã–ª env –≤–∞—Ä

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

- `git clone` —ç—Ç–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `npm i` –≤ —Å–∫–∞—á–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ wrangler –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `wrangler r2 bucket create NAME` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è R2 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- `wrangler secret put ENCRYPT_SECRET` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–æ–ª—è –≤ –ø—Ä–æ–¥–µ (–µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤–æ)
- –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `wrangler.toml`, –∫–∞–∫ –Ω–∞–ø–∏—Å–∞–Ω–æ –≤—ã—à–µ
- `wrangler dev --remote --env development` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ –∏ `wrangler deploy`, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –≤–æ—Ä–∫–µ—Ä. `--remote` –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å remote –±–∞–∫–µ—Ç–æ–º. –ë–µ–∑ –Ω–µ–≥–æ –±–∞–∫–µ—Ç –±—É–¥–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–º
- `wrangler deploy `

## Curl –¥–ª—è —Ç–µ—Å—Ç–æ–≤

`xxx` —ç—Ç–æ `ENCRYPT_SECRET`

–ï—Å–ª–∏ –∑–∞–ª–∏—Ç—å –¥–≤–∞ —Ñ–∞–π–ª–∞ –ø–æ –æ–¥–Ω–æ–º—É `/path`, —Ç–æ –Ω–æ–≤—ã–π —Ñ–∞–π–ª –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Å—Ç–∞—Ä—ã–π. –ï—Å–ª–∏ –∑–∞–ª–∏—Ç—å —Ñ–∞–π–ª –ø–æ –ø—É—Ç–∏ /, —Ç–æ —É –Ω–µ–≥–æ –Ω–µ –±—É–¥–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏—è. DELETE / —É–¥–∞–ª–∏–ª —ç—Ç–æ—Ç —Å–∞–º—ã–π —Ñ–∞–π–ª –±–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, –∞ –Ω–µ –≤—Å—é –ø–∞–ø–∫—É

- `curl -X POST -H "Authorization: xxx" -F "file=@file.ext" http://localhost:8787/file_path.ext`
- `curl -X DELETE -H "Authorization: xxx" http://localhost:8787/file_path.ext`
- `curl http://localhost:8787/file_path.ext`


